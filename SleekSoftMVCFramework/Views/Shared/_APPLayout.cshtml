<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title SleekSoft</title>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->


    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")

</head>
@using Microsoft.AspNet.Identity
@using SleekSoftMVCFramework.Utilities
@using SleekSoftMVCFramework.Data.IdentityService.Extensions
@using System.Security.Claims

@{
    var userFullName = (User.Identity as ClaimsIdentity).FindFirstValue("FullName");

}
<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">
        <header class="main-header">
            <!-- Logo -->
            <a href="#" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->
                <span class="logo-mini"><b>A</b>LT</span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg"><b>SleekSoft</b> Framework</span>
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top">
                <!-- Sidebar toggle button-->
                <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                    <span class="sr-only">Toggle navigation</span>
                </a>
                <!-- Navbar Right Menu -->
                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav" style="padding-right: 40px;">
                        <!-- User Account: style can be found in dropdown.less -->
                        <li class="dropdown user user-menu">
                            <a href="@Url.Action("MyProfile","Home",new { area = "" })" class="dropdown-toggle">
                                <img src="@Url.Content("~/img/user2-160x160.jpg")" class="user-image" alt="User Image" />
                                <span class="hidden-xs">
                                    @if (Request.IsAuthenticated)
                                    {
                                        <b>Welcome , @userFullName</b>
                                    }
                                </span>
                            </a>
                        </li>
                        <li class="dropdown user user-menu" style="color: #fff;padding-top: 15px;">
                            @Html.Partial("_LoginPartial")
                        </li>

                        <!-- Control Sidebar Toggle Button -->

                    </ul>
                </div>
            </nav>
        </header>
        <!-- Left side column. contains the logo and sidebar -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">
                <!-- Sidebar user panel -->
                <div class="user-panel">
                    <div class="pull-left image">
                        <img src="@Url.Content("~/img/user2-160x160.jpg")" class="img-circle" alt="User Image">
                    </div>

                </div>
                <!-- search form -->
                @*<form action="#" method="get" class="sidebar-form">
                        <div class="input-group">
                            <input type="text" name="q" class="form-control" placeholder="Search...">
                            <span class="input-group-btn">
                                <button name="search" id="search-btn" class="btn btn-flat">
                                    <i class="fa fa-search"></i>
                                </button>
                            </span>
                        </div>
                    </form>*@
                <!-- /.search form -->
                <!-- sidebar menu: : style can be found in sidebar.less -->
                <ul class="sidebar-menu">
                    <li class="header">MAIN NAVIGATION</li>
                    <li class="active treeview">
                        <a href="/">
                            <i class="fa fa-dashboard"></i> <span>Dashboard</span>

                        </a>

                    </li>
                    <!-- Parial Layout goes here -->
                    @if (User.IsInRole("PortalAdmin"))
                    {
                         @Html.Partial("_PortalMenu")
                    }

                    @Html.Partial("_ActivityLogMenu")
                    @Html.Partial("_ForumMenu")
                </ul>
            </section>
            <!-- /.sidebar -->
        </aside>
        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            @RenderBody()
        </div>
        <!-- /.content-wrapper -->
        <footer class="main-footer">
            <div class="pull-right hidden-xs">
                <b>Version</b> 2.3.7
            </div>
            <strong>Copyright &copy; 2017 <a href="http://www.vatebra.com">VATEBRA</a>.</strong> All rights
            reserved.
        </footer>


    </div>
    <!-- ./wrapper -->
    <script type="text/javascript">
        $(function () {
            var url = '';
            function bindForm(dialog) {
                $("form", dialog).submit(function () {
                    $.ajax({
                        url: this.action,
                        type: this.method,
                        data: $(this).serialize(),
                        success: function (result) {
                            if (result.success) {
                                $('#addedit_modal').modal("hide");
                                // Refresh:
                                location.reload();

                            } else {

                                $('#addedit_modal_body').html(result);
                                bindForm();
                            }
                        }, error: function (request, status, error) {
                            alert(JSON.stringify(error));
                        }
                    });


                    return false;
                });
            }

            //Load the edit page
            $(".btn_changepassword").click(function () {

                url = "@Url.Action("ChangePassword", "Account", new { area = "" })";
                console.log(url);

                $("#addedit_modal_body").load(url, function () {
                    $("#addedit_modal").modal({
                        backdrop: 'static',
                        keyboard: true
                    }, "show");
                    bindForm(this);
                });
                return false;
            });


        });

    </script>

    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/jqueryval")
    @RenderSection("scripts", required: false)
    @RenderSection("JavaScript", required: false)
</body>
</html>
